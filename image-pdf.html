<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
      <title>Images → PDF (mobile)</title>
        <style>
            body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;padding:16px;background:#f7f7f8;color:#111}
                .card{background:white;border-radius:12px;padding:14px;box-shadow:0 6px 18px rgba(0,0,0,0.06);max-width:780px;margin:0 auto}
                    h1{font-size:18px;margin:0 0 12px}
                        label.button{display:inline-block;padding:10px 14px;border-radius:10px;background:#0b66ff;color:#fff;cursor:pointer;margin-bottom:10px}
                            input[type=file]{display:none}
                                .controls{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
                                    button.action{padding:10px 14px;border-radius:10px;background:#111;color:#fff;border:0;cursor:pointer}
                                        button.action[disabled]{opacity:.5;cursor:not-allowed}
                                            .small{font-size:13px;color:#666;margin-top:6px}
                                                #preview{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
                                                    #preview img{height:84px;border-radius:8px;object-fit:cover}
                                                        progress{width:100%;height:10px}
                                                          </style>
                                                            <!-- jsPDF UMD build (CDN). Works in Chrome mobile. -->
                                                              <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
                                                              </head>
                                                              <body>
                                                                <div class="card">
                                                                    <h1>Convert Photos → PDF (works on mobile Chrome)</h1>

                                                                        <div class="controls">
                                                                              <label class="button" for="images">Choose images</label>
                                                                                    <input id="images" type="file" accept="image/*" multiple>

                                                                                          <button id="create" class="action" disabled>Create PDF</button>
                                                                                                <button id="clear" class="action" disabled>Clear</button>
                                                                                                    </div>

                                                                                                        <div class="small">Options: PDF page size A4, images fit page with margins; portrait/landscape auto-picked per-image.</div>

                                                                                                            <div id="status" class="small" style="margin-top:8px"></div>

                                                                                                                <progress id="progress" value="0" max="100" style="display:none"></progress>

                                                                                                                    <div id="preview"></div>
                                                                                                                      </div>

                                                                                                                      <script>
                                                                                                                      (async function(){
                                                                                                                        const input = document.getElementById('images');
                                                                                                                          const createBtn = document.getElementById('create');
                                                                                                                            const clearBtn = document.getElementById('clear');
                                                                                                                              const preview = document.getElementById('preview');
                                                                                                                                const status = document.getElementById('status');
                                                                                                                                  const progress = document.getElementById('progress');

                                                                                                                                    let files = [];

                                                                                                                                      input.addEventListener('change', (e) => {
                                                                                                                                          files = Array.from(e.target.files).filter(f => f.type.startsWith('image/'));
                                                                                                                                              renderPreview();
                                                                                                                                                });

                                                                                                                                                  clearBtn.addEventListener('click', () => {
                                                                                                                                                      files = [];
                                                                                                                                                          input.value = '';
                                                                                                                                                              renderPreview();
                                                                                                                                                                });

                                                                                                                                                                  createBtn.addEventListener('click', () => createPDF(files));

                                                                                                                                                                    function renderPreview(){
                                                                                                                                                                        preview.innerHTML = '';
                                                                                                                                                                            if (files.length === 0) {
                                                                                                                                                                                  status.textContent = 'No images selected.';
                                                                                                                                                                                        createBtn.disabled = true;
                                                                                                                                                                                              clearBtn.disabled = true;
                                                                                                                                                                                                    return;
                                                                                                                                                                                                        }
                                                                                                                                                                                                            createBtn.disabled = false;
                                                                                                                                                                                                                clearBtn.disabled = false;
                                                                                                                                                                                                                    status.textContent = `${files.length} image(s) selected. Preview:`;
                                                                                                                                                                                                                        files.forEach(f => {
                                                                                                                                                                                                                              const img = document.createElement('img');
                                                                                                                                                                                                                                    img.alt = f.name;
                                                                                                                                                                                                                                          const url = URL.createObjectURL(f);
                                                                                                                                                                                                                                                img.src = url;
                                                                                                                                                                                                                                                      img.onload = () => URL.revokeObjectURL(url);
                                                                                                                                                                                                                                                            preview.appendChild(img);
                                                                                                                                                                                                                                                                });
                                                                                                                                                                                                                                                                  }

                                                                                                                                                                                                                                                                    async function createPDF(files) {
                                                                                                                                                                                                                                                                        if (!files.length) return;
                                                                                                                                                                                                                                                                            // jsPDF from UMD bundle:
                                                                                                                                                                                                                                                                                const { jsPDF } = window.jspdf;

                                                                                                                                                                                                                                                                                    // Create PDF object for first page orientation will be set per-page.
                                                                                                                                                                                                                                                                                        // But we'll instantiate a single jsPDF and add pages.
                                                                                                                                                                                                                                                                                            // A4 dimensions in mm:
                                                                                                                                                                                                                                                                                                const A4 = { w: 210, h: 297 };
                                                                                                                                                                                                                                                                                                    const margin = 10; // mm

                                                                                                                                                                                                                                                                                                        const pdf = new jsPDF({ unit: 'mm', format: 'a4' });

                                                                                                                                                                                                                                                                                                            progress.style.display = 'block';
                                                                                                                                                                                                                                                                                                                progress.value = 0;
                                                                                                                                                                                                                                                                                                                    status.textContent = 'Processing images...';

                                                                                                                                                                                                                                                                                                                        for (let i = 0; i < files.length; i++) {
                                                                                                                                                                                                                                                                                                                              const file = files[i];
                                                                                                                                                                                                                                                                                                                                    status.textContent = `Processing ${i+1} of ${files.length}: ${file.name}`;
                                                                                                                                                                                                                                                                                                                                          progress.value = Math.round((i/files.length)*100);

                                                                                                                                                                                                                                                                                                                                                // Load image into an HTMLImageElement (via canvas to allow compression)
                                                                                                                                                                                                                                                                                                                                                      const dataUrl = await readFileAsDataURL(file);
                                                                                                                                                                                                                                                                                                                                                            const img = await loadImage(dataUrl);

                                                                                                                                                                                                                                                                                                                                                                  // draw to canvas to optionally convert to JPEG and reduce size (quality)
                                                                                                                                                                                                                                                                                                                                                                        const compressedDataUrl = await compressToJpeg(img, 0.85);

                                                                                                                                                                                                                                                                                                                                                                              // pick orientation: if image is wider than tall, use landscape on that page
                                                                                                                                                                                                                                                                                                                                                                                    const isLandscape = img.naturalWidth > img.naturalHeight;

                                                                                                                                                                                                                                                                                                                                                                                          const pageW = isLandscape ? A4.h : A4.w;
                                                                                                                                                                                                                                                                                                                                                                                                const pageH = isLandscape ? A4.w : A4.h;

                                                                                                                                                                                                                                                                                                                                                                                                      // compute image display size in mm to fit within page minus margins, preserving aspect
                                                                                                                                                                                                                                                                                                                                                                                                            const maxW = pageW - margin*2;
                                                                                                                                                                                                                                                                                                                                                                                                                  const maxH = pageH - margin*2;
                                                                                                                                                                                                                                                                                                                                                                                                                        const imgRatio = img.naturalWidth / img.naturalHeight;

                                                                                                                                                                                                                                                                                                                                                                                                                              let drawW = maxW;
                                                                                                                                                                                                                                                                                                                                                                                                                                    let drawH = drawW / imgRatio;
                                                                                                                                                                                                                                                                                                                                                                                                                                          if (drawH > maxH) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                  drawH = maxH;
                                                                                                                                                                                                                                                                                                                                                                                                                                                          drawW = drawH * imgRatio;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                      // for first page, set orientation accordingly. For subsequent pages addPage with orientation.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (i === 0) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // If first page needs landscape but created default as portrait, recreate pdf with right orientation.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            if (isLandscape) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      pdf.setProperties({}); // no-op, just to ensure pdf exists
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // jsPDF constructor's orientation only sets at creation. Re-initialize:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          // workaround: create new pdf and copy nothing, so we'll re-create:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // simpler approach: create pdf initially as portrait, but use internal addPage with size and rotate image accordingly.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              // jsPDF supports specifying orientation in addPage. We'll use addPage for subsequent pages.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    pdf.addPage([pageW, pageH], isLandscape ? 'landscape' : 'portrait');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // compute coordinates to center
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      const x = (pageW - drawW) / 2;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const y = (pageH - drawH) / 2;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  // add image on current page (jsPDF places images using coordinates in current page units mm)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Since we might have created the page in a different orientation than the initial one,
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              // ensure we're on the correct page number:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // For the very first image (i===0) we may need to set page size/orientation by resizing the internal canvas:
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          if (i === 0) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  // If first page orientation mismatches, manually set user unit and rotate by using addImage with page size.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          // Easiest reliable behavior: if first image is landscape, recreate pdf with landscape and then add image.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  if (isLandscape) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Recreate pdf in landscape and continue (preserve any pages so far — none).
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      // Create a new one and replace variable.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                const newPdf = new jsPDF({ unit: 'mm', format: [pageW, pageH], orientation: 'landscape' });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          // Replace pdf variable reference
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // Note: jsPDF doesn't provide a clean way to move pages; but since this is first page, safe to replace.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              pdf.internal = newPdf.internal;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        pdf.__private__ = newPdf.__private__; // (not standard but works with this build) - if not, continue with newPdf
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  // To be safe, fallback: if replacement fails, just continue with original pdf and add image in calculation coords.
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      // Add the image
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            try {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    pdf.addImage(compressedDataUrl, 'JPEG', x, y, drawW, drawH);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          } catch (err) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  // fallback: try PNG if JPEG fails
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          pdf.addImage(compressedDataUrl, 'PNG', x, y, drawW, drawH);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        progress.value = 100;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            status.textContent = 'Finalizing PDF...';

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                // Prepare filename
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    const now = new Date();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        const filename = `photos_${now.getFullYear()}${String(now.getMonth()+1).padStart(2,'0')}${String(now.getDate()).padStart(2,'0')}.pdf`;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Save (this triggers download on mobile Chrome)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                pdf.save(filename);

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    status.textContent = `Saved ${filename} — check your Downloads folder.`;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        setTimeout(()=>progress.style.display='none',800);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Helpers
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              function readFileAsDataURL(file){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  return new Promise((res, rej) => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        const r = new FileReader();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              r.onload = () => res(r.result);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    r.onerror = rej;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          r.readAsDataURL(file);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  function loadImage(dataUrl){
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      return new Promise((res, rej) => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            const img = new Image();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  img.onload = () => res(img);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        img.onerror = rej;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              // mobile chrome sometimes blocks crossOrigin unless set; but using local data URL is fine
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    img.src = dataUrl;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // draw to canvas and export as JPEG to reduce size (quality 0.85)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              function compressToJpeg(img, quality=0.85) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  return new Promise((res) => {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // limit max canvas pixels to reasonable size to avoid huge memory use on mobile
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              const MAX_PIXELS = 2500 * 2500; // safe guard
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    let w = img.naturalWidth, h = img.naturalHeight;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          const pixels = w*h;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                if (pixels > MAX_PIXELS) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        const scale = Math.sqrt(MAX_PIXELS / pixels);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                w = Math.round(w * scale);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        h = Math.round(h * scale);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    const canvas = document.createElement('canvas');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          canvas.width = w;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                canvas.height = h;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      const ctx = canvas.getContext('2d');
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            // Fill white to avoid black background for transparent images
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ctx.fillStyle = '#ffffff';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ctx.fillRect(0,0,canvas.width, canvas.height);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    // convert to JPEG
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          const dataUrl = canvas.toDataURL('image/jpeg', quality);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                res(dataUrl);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    });
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      })();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </body>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      </html>